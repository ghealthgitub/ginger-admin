<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treatments | Ginger Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="/css/listing.css">
</head>
<body>
<div class="layout">
    <aside class="sidebar" id="sidebar"></aside>
    <main class="main">
        <header class="topbar">
            <button class="topbar__menu" onclick="document.getElementById('sidebar').classList.toggle('open')">☰</button>
            <h1 class="topbar__title" id="pageTitle">Treatments</h1>
            <div class="topbar__actions"></div>
        </header>
        <div class="content">
            <div class="status-tabs" id="statusTabs"></div>
            <div class="selected-bar" id="selectedBar">
                <span id="selectedCount">0 selected</span>
                <button class="btn-clear" onclick="Listing.clearSel()">✕ Clear selection</button>
            </div>
            <div class="toolbar" id="filterToolbar"></div>
            <div class="card">
                <div class="card__body" style="padding:0;overflow-x:auto">
                    <table class="data-table" id="listTable">
                        <thead><tr></tr></thead>
                        <tbody id="list">
                            <tr><td colspan="10" class="empty-state loading-state">
                                <div class="loading-spinner"></div> Loading...
                            </td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>
<div class="listing-toast" id="listingToast"></div>

<script src="/js/sidebar.js" defer></script>
<script src="/js/listing.js"></script>
<script>
window.LISTING = {
    cpt: 'treatment',
    apiEndpoint: '/api/treatments',
    newUrl: '/treatments/new',
    editUrl: (item) => '/treatments/edit/' + item.id,
    viewUrl: (item) => item.specialty_slug && item.slug && item.status === 'published'
        ? 'https://ginger.healthcare/specialties/' + item.specialty_slug + '/' + item.slug + '/'
        : null,
    slugDisplay: (item) => '/specialties/' + (item.specialty_slug || '...') + '/' + (item.slug || '') + '/',
    imageField: 'image',
    columns: [
        { key: 'specialty_name', label: 'Specialty',  badge: 'purple',
          sortKey: 'specialty' },
        { key: 'duration',       label: 'Duration' },
        { key: 'cost_range_usd', label: 'Cost (USD)' },
    ],
    filters: [
        {
            id: 'specFilter',
            apiSource: '/api/specialties',
            placeholder: 'All Specialties',
            filterFn: (item, val) => !val || String(item.specialty_id) === val
        }
    ],
    quickEditFields: [
        { id: 'name',           label: 'Name',          type: 'text' },
        { id: 'slug',           label: 'Slug',          type: 'text' },
        { id: 'specialty_id',   label: 'Specialty',     type: 'select', source: 'specFilter' },
        { id: 'status',         label: 'Status',        type: 'status' },
        { id: 'duration',       label: 'Duration',      type: 'text' },
        { id: 'recovery_time',  label: 'Recovery Time', type: 'text' },
        { id: 'success_rate',   label: 'Success Rate',  type: 'text' },
        { id: 'cost_range_usd', label: 'Cost (USD)',    type: 'text' },
    ],
    defaultSort: 'date',
    defaultDir: 'desc',
};
</script>
</body>
</html>
