<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treatment Studio | Ginger Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <link href="/css/studio.css" rel="stylesheet">
</head>
<body>
<script>
window.STUDIO = {
    cpt:              'treatment',
    apiEndpoint:      '/api/treatments',
    aiType:           'treatment',
    backUrl:          '/treatments',
    titlePlaceholder: 'Treatment name...',

    // Metadata fields unique to Treatments
    metaFields: [
        { id: 'specialty_id',  label: 'Specialty',    type: 'select', source: '/api/specialties', flex: '2' },
        { id: 'duration',      label: 'Duration',     type: 'text',   width: '120px', placeholder: 'e.g. 2-4 hours' },
        { id: 'recovery_time', label: 'Recovery',     type: 'text',   width: '120px', placeholder: 'e.g. 2-3 weeks' },
        { id: 'success_rate',  label: 'Success Rate', type: 'text',   width: '100px', placeholder: 'e.g. 95%' },
        { id: 'cost_range_usd',label: 'Cost (USD)',   type: 'text',   width: '170px', placeholder: 'e.g. $5,000-$15,000' }
    ],

    // Publish validations (checked before publishing)
    publishValidations: [
        {
            field:   'specialty_id',
            fieldId: 'specialty_id',
            message: '⚠️ Specialty is required to publish.\n\nTreatments must be linked to a specialty so they appear at the correct URL.'
        }
    ],

    // Dynamic permalink: ginger.healthcare/specialties/{specialty-slug}/{treatment-slug}/
    onPermalinkChange(studio) {
        const sel   = document.getElementById('specialty_id');
        const opt   = sel ? sel.options[sel.selectedIndex] : null;
        const sSlug = opt && opt.dataset.slug ? opt.dataset.slug : null;
        const base  = document.getElementById('permalinkBase');
        if (base) base.textContent = sSlug
            ? 'ginger.healthcare/specialties/' + sSlug + '/'
            : 'ginger.healthcare/specialties/.../';
    },

    // View on site URL after publishing
    viewUrl(item) {
        const sel   = document.getElementById('specialty_id');
        const opt   = sel ? sel.options[sel.selectedIndex] : null;
        const sSlug = opt && opt.dataset.slug ? opt.dataset.slug : null;
        return sSlug
            ? 'https://ginger.healthcare/specialties/' + sSlug + '/' + item.slug + '/'
            : 'https://ginger.healthcare/treatments/' + item.slug + '/';
    }
};
</script>
<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script src="/js/studio.js"></script>
</body>
</html>
