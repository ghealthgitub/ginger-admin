<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/admin.css"><title>Specialties | Ginger Admin</title><link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<style>.ql-editor{min-height:150px;font-size:.92rem;line-height:1.7;font-family:"DM Sans",sans-serif}.ql-toolbar{border-color:var(--gray-200)!important;background:var(--gray-50);border-radius:8px 8px 0 0}.ql-container{border-color:var(--gray-200)!important;border-radius:0 0 8px 8px}</style>
</head><body><div class="layout"><aside class="sidebar" id="sidebar"></aside><main class="main"><header class="topbar"><button class="topbar__menu" onclick="document.getElementById('sidebar').classList.toggle('open')">‚ò∞</button><h1 class="topbar__title">Specialties (28)</h1><div class="topbar__actions"><button class="btn btn--primary" onclick="openModal()">+ Add Specialty</button></div></header><div class="content"><div class="toolbar"><input type="text" class="search-input" placeholder="Search specialties..." id="searchInput" oninput="filter()"><select class="form-select" style="width:auto" id="catFilter" onchange="filter()"><option value="">All Categories</option><option value="surgical">Surgical</option><option value="medical">Medical</option><option value="oncology">Oncology</option><option value="super_specialty">Super Specialty</option></select></div><div class="card"><div class="card__body"><table class="data-table"><thead><tr><th>Icon</th><th>Specialty</th><th>Category</th><th>Treatments</th><th>Status</th><th>Actions</th></tr></thead><tbody id="list"><tr><td colspan="6" class="loading">Loading...</td></tr></tbody></table></div></div></div>
<div class="modal-overlay" id="modal"><div class="modal"><div class="modal__header"><h3 id="modalTitle">Add Specialty</h3><button class="modal__close" onclick="closeModal()">‚úï</button></div><div class="modal__body">
<div class="form-row"><div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" id="f_name" oninput="document.getElementById('f_slug').value=this.value.toLowerCase().replace(/[^a-z0-9]+/g,'-')"></div><div class="form-group"><label class="form-label">Icon (emoji)</label><input type="text" class="form-input" id="f_icon" placeholder="‚ù§Ô∏è"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Slug</label><input type="text" class="form-input" id="f_slug"></div><div class="form-group"><label class="form-label">Category</label><select class="form-select" id="f_category"><option value="surgical">Surgical</option><option value="medical">Medical</option><option value="oncology">Oncology</option><option value="super_specialty">Super Specialty</option></select></div></div>
<div class="form-group"><label class="form-label">Short Description</label><textarea class="form-textarea" id="f_desc" style="min-height:60px" placeholder="Brief summary (1-2 sentences)"></textarea></div>
<div class="form-group"><label class="form-label">Detailed Description (Rich Text)</label><div id="f_longdesc_editor"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Treatment Count</label><input type="number" class="form-input" id="f_count"></div><div class="form-group"><label class="form-label">Display Order</label><input type="number" class="form-input" id="f_order" placeholder="0"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Meta Title (SEO)</label><input type="text" class="form-input" id="f_meta_title" placeholder="SEO title"></div><div class="form-group"><label class="form-label">Meta Description (SEO)</label><input type="text" class="form-input" id="f_meta_desc" placeholder="SEO description"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Is Featured</label><select class="form-select" id="f_featured"><option value="false">No</option><option value="true">Yes</option></select></div><div class="form-group"><label class="form-label">Status</label><select class="form-select" id="f_status"><option value="draft">Draft</option><option value="published">Published</option></select></div></div>
</div><div class="modal__footer"><button class="btn btn--outline" onclick="closeModal()">Cancel</button><button class="btn btn--primary" onclick="saveItem()">Save</button></div></div></div></main></div>
<script>let items=[],editId=null;
async function load(){const r=await fetch('/api/specialties');items=await r.json();render()}
function render(){filter()}
function filter(){const q=document.getElementById('searchInput').value.toLowerCase();const c=document.getElementById('catFilter').value;const f=items.filter(s=>(s.name.toLowerCase().includes(q))&&(!c||s.category===c));const tb=document.getElementById('list');if(!f.length){tb.innerHTML='<tr><td colspan="6" class="empty-state">No specialties found</td></tr>';return}
tb.innerHTML=f.map(s=>`<tr><td style="font-size:1.3rem">${s.icon||'üè∑Ô∏è'}</td><td><strong>${s.name}</strong><br><span style="font-size:.75rem;color:var(--gray-400)">/${s.slug}/</span></td><td>${s.category}</td><td>${s.treatment_count||0}</td><td><span class="badge badge--${s.status}">${s.status}</span></td><td><button class="btn btn--outline btn--sm" onclick="editItem(${s.id})">Edit</button> <button class="btn btn--danger btn--sm" onclick="deleteItem(${s.id})">üóë</button></td></tr>`).join('')}
function openModal(){editId=null;document.getElementById('modal').classList.add('open');['f_name','f_slug','f_icon','f_desc','f_count'].forEach(f=>document.getElementById(f).value='')}
function closeModal(){document.getElementById('modal').classList.remove('open')}
function editItem(id){const s=items.find(i=>i.id===id);if(!s)return;editId=id;document.getElementById('modal').classList.add('open');document.getElementById('f_name').value=s.name;document.getElementById('f_slug').value=s.slug;document.getElementById('f_icon').value=s.icon||'';document.getElementById('f_category').value=s.category||'surgical';document.getElementById('f_desc').value=s.description||'';document.getElementById('f_count').value=s.treatment_count||0;document.getElementById('f_status').value=s.status}
async function saveItem(){const data={name:document.getElementById('f_name').value,slug:document.getElementById('f_slug').value,icon:document.getElementById('f_icon').value,category:document.getElementById('f_category').value,description:document.getElementById('f_desc').value,treatment_count:parseInt(document.getElementById('f_count').value)||0,status:document.getElementById('f_status').value};
const url=editId?'/api/specialties/'+editId:'/api/specialties';const method=editId?'PUT':'POST';const r=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(r.ok){closeModal();load()}else{const e=await r.json();alert(e.error)}}
async function deleteItem(id){if(!confirm('Delete?'))return;await fetch('/api/specialties/'+id,{method:'DELETE'});load()}
load();</script><script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script>
let quillDesc;
function initQuill(){
    if(quillDesc)return;
    quillDesc=new Quill('#f_longdesc_editor',{theme:'snow',placeholder:'Detailed description with formatting...',modules:{toolbar:[['bold','italic','underline'],[{'header':[2,3,false]}],[{'list':'ordered'},{'list':'bullet'}],['link'],['clean']]}});
}
// Init when modal opens
const origOpen=openModal;openModal=function(){origOpen();setTimeout(initQuill,100)};
const origEdit=editItem;editItem=function(id){origEdit(id);setTimeout(()=>{initQuill();const s=items.find(i=>i.id===id);if(s&&quillDesc)quillDesc.root.innerHTML=s.long_description||'';document.getElementById('f_order').value=s.display_order||0;document.getElementById('f_meta_title').value=s.meta_title||'';document.getElementById('f_meta_desc').value=s.meta_description||'';document.getElementById('f_featured').value=s.is_featured?'true':'false'},150)};
// Override save to include new fields
const origSave=saveItem;saveItem=async function(){
    const data={name:document.getElementById('f_name').value,slug:document.getElementById('f_slug').value,icon:document.getElementById('f_icon').value,category:document.getElementById('f_category').value,description:document.getElementById('f_desc').value,long_description:quillDesc?quillDesc.root.innerHTML:'',treatment_count:parseInt(document.getElementById('f_count').value)||0,display_order:parseInt(document.getElementById('f_order').value)||0,meta_title:document.getElementById('f_meta_title').value,meta_description:document.getElementById('f_meta_desc').value,is_featured:document.getElementById('f_featured').value==='true',status:document.getElementById('f_status').value};
    const url=editId?'/api/specialties/'+editId:'/api/specialties';const method=editId?'PUT':'POST';
    const r=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
    if(r.ok){closeModal();load()}else{const e=await r.json();alert(e.error)}
};
</script>
<script src="/js/sidebar.js"></script>
</body></html>
