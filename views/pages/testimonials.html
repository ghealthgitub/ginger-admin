<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/admin.css"><title>Testimonials | Ginger Admin</title><script src="/js/sidebar.js" defer></script>
</head><body><div class="layout"><aside class="sidebar" id="sidebar"></aside><main class="main"><header class="topbar"><button class="topbar__menu" onclick="document.getElementById('sidebar').classList.toggle('open')">â˜°</button><h1 class="topbar__title">Testimonials</h1><div class="topbar__actions"><button class="btn btn--primary" onclick="openModal()">+ Add Testimonial</button></div></header><div class="content"><div class="card"><div class="card__body"><table class="data-table"><thead><tr><th>Patient</th><th>Country</th><th>Treatment</th><th>Rating</th><th>Status</th><th>Actions</th></tr></thead><tbody id="list"><tr><td colspan="6" class="loading">Loading...</td></tr></tbody></table></div></div></div>
<div class="modal-overlay" id="modal"><div class="modal"><div class="modal__header"><h3 id="modalTitle">Add Testimonial</h3><button class="modal__close" onclick="closeModal()">âœ•</button></div><div class="modal__body">
<div class="form-row"><div class="form-group"><label class="form-label">Patient Name</label><input type="text" class="form-input" id="f_name"></div><div class="form-group"><label class="form-label">Country</label><input type="text" class="form-input" id="f_country" placeholder="e.g. USA"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Flag Emoji</label><input type="text" class="form-input" id="f_flag" placeholder="ðŸ‡ºðŸ‡¸"></div><div class="form-group"><label class="form-label">Rating (1-5)</label><input type="number" class="form-input" id="f_rating" value="5" min="1" max="5"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Treatment</label><input type="text" class="form-input" id="f_treatment"></div><div class="form-group"><label class="form-label">Destination</label><input type="text" class="form-input" id="f_destination" placeholder="India"></div></div>
<div class="form-group"><label class="form-label">Quote</label><textarea class="form-textarea" id="f_quote" placeholder="Patient testimonial..."></textarea></div>
<div class="form-group"><label class="form-label">Status</label><select class="form-select" id="f_status"><option value="draft">Draft</option><option value="published">Published</option></select></div>
<div style="margin-top:12px"><button class="btn btn--teal" onclick="aiWriteTestimonial()" style="width:100%">ðŸ¤– Generate with Claude AI</button></div>
</div><div class="modal__footer"><button class="btn btn--outline" onclick="closeModal()">Cancel</button><button class="btn btn--primary" onclick="saveItem()">Save</button></div></div></div>
</main></div><script>
let items=[],editId=null;
async function load(){const r=await fetch('/api/testimonials');items=await r.json();render()}
function render(){const tb=document.getElementById('list');if(!items.length){tb.innerHTML='<tr><td colspan="6" class="empty-state">No testimonials yet</td></tr>';return}
tb.innerHTML=items.map(t=>`<tr><td><strong>${t.patient_name}</strong></td><td>${t.patient_flag||''} ${t.patient_country||''}</td><td>${t.treatment||'-'}</td><td>${'â˜…'.repeat(t.rating)}</td><td><span class="badge badge--${t.status}">${t.status}</span></td><td><button class="btn btn--outline btn--sm" onclick="editItem(${t.id})">Edit</button> <button class="btn btn--danger btn--sm" onclick="deleteItem(${t.id})">ðŸ—‘</button></td></tr>`).join('')}
function openModal(){editId=null;document.getElementById('modal').classList.add('open');document.getElementById('modalTitle').textContent='Add Testimonial';['f_name','f_country','f_flag','f_treatment','f_destination','f_quote'].forEach(f=>document.getElementById(f).value='');document.getElementById('f_rating').value=5;document.getElementById('f_status').value='draft'}
function closeModal(){document.getElementById('modal').classList.remove('open')}
function editItem(id){const t=items.find(i=>i.id===id);if(!t)return;editId=id;document.getElementById('modal').classList.add('open');document.getElementById('modalTitle').textContent='Edit Testimonial';document.getElementById('f_name').value=t.patient_name||'';document.getElementById('f_country').value=t.patient_country||'';document.getElementById('f_flag').value=t.patient_flag||'';document.getElementById('f_rating').value=t.rating||5;document.getElementById('f_treatment').value=t.treatment||'';document.getElementById('f_destination').value=t.destination||'';document.getElementById('f_quote').value=t.quote||'';document.getElementById('f_status').value=t.status||'draft'}
async function saveItem(){const data={patient_name:document.getElementById('f_name').value,patient_country:document.getElementById('f_country').value,patient_flag:document.getElementById('f_flag').value,rating:parseInt(document.getElementById('f_rating').value),treatment:document.getElementById('f_treatment').value,destination:document.getElementById('f_destination').value,quote:document.getElementById('f_quote').value,status:document.getElementById('f_status').value};
const url=editId?'/api/testimonials/'+editId:'/api/testimonials';const method=editId?'PUT':'POST';
const r=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(r.ok){closeModal();load()}else{alert('Error saving')}}
async function deleteItem(id){if(!confirm('Delete?'))return;await fetch('/api/testimonials/'+id,{method:'DELETE'});load()}
async function aiWriteTestimonial(){const treatment=document.getElementById('f_treatment').value||'medical treatment';const country=document.getElementById('f_destination').value||'India';
const r=await fetch('/api/ai/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt:'Write a short, authentic patient testimonial (2-3 sentences) about '+treatment+' in '+country+'. Make it emotional and specific about savings and quality.',type:'testimonial'})});
const data=await r.json();if(r.ok)document.getElementById('f_quote').value=data.content}
</script>
</body></html>
